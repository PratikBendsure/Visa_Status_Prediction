"""Untitled6.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1-fKjQyylkJ8M8NB-L0aa0kEGDBYow0lP
"""

# pandas is used to load and clean your data.
# LabelEncoder converts text (like country names) into numbers for machine learning.
import pandas as pd
from sklearn.preprocessing import LabelEncoder

# This loads your file raw_visa_data.csv into a table format (DataFrame).
# df.head() shows the first 5 rows to confirm the data loaded correctly.
df = pd.read_csv("raw_visa_data.csv")
df.head()

# info() shows column types (object, int, date).
# isnull().sum() shows how many missing values exist in each column.
df.info()
df.isnull().sum()

# Text columns missing values are replaced with a default "Unknown".
# Age is a number â†’ we fill missing values using the median age.
df['country'] = df['country'].fillna("Unknown")
df['visa_type'] = df['visa_type'].fillna("Unknown")
df['processing_center'] = df['processing_center'].fillna("Unknown")
df['gender'] = df['gender'].fillna("Unknown")
df['age'] = df['age'].fillna(df['age'].median())

print(df.head().to_string())

# This step converts them into actual date format, so we can calculate time differences.
df['submission_date'] = pd.to_datetime(df['submission_date'])
df['decision_date'] = pd.to_datetime(df['decision_date'])

print(df[['submission_date','decision_date']].head().to_string())

# This calculates how many days it took to process each visa application.
df['processing_days'] = (df['decision_date'] - df['submission_date']).dt.days

print(df[['submission_date','decision_date','processing_days']].head().to_string())

le = LabelEncoder()

df['country_encoded'] = le.fit_transform(df['country'])
df['visa_type_encoded'] = le.fit_transform(df['visa_type'])
df['gender_encoded'] = le.fit_transform(df['gender'])
df['center_encoded'] = le.fit_transform(df['processing_center'])

print(df[['country', 'country_encoded',
          'visa_type', 'visa_type_encoded',
          'gender', 'gender_encoded',
          'processing_center', 'center_encoded']].head().to_string())

#remove undedded column
df_clean = df.drop(['country','visa_type','gender','processing_center','decision_date'], axis=1)
df_clean.head()

#displays cleaned dataset
df_clean.head()
